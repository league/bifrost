
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Monitoring Tools &#8212; bifrost 0.6 documentation</title>
    <link rel="stylesheet" type="text/css" href="static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="static/documentation_options.js"></script>
    <script src="static/jquery.js"></script>
    <script src="static/underscore.js"></script>
    <script src="static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Fast GPU math using bfMap" href="bfmap.html" />
    <link rel="prev" title="5. Views" href="views.html" />
   
  <link rel="stylesheet" href="static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="monitoring-tools">
<h1><span class="section-number">6. </span>Monitoring Tools<a class="headerlink" href="#monitoring-tools" title="Permalink to this headline">¶</a></h1>
<p>Bifrost provides some command-line tools for monitoring the performance of running pipelines.
In the <code class="docutils literal notranslate"><span class="pre">tools/</span></code> directory there are</p>
<p><em>(aka seeing C in Python pipelines)</em></p>
<p>Bifrost is based on two maxims: 1) by itself, C sucks. 2) by itself,
Python sucks.</p>
<p>Bifrost bridges the two languages using some clever python libraries, a
customized numpy array class, and enforcing some pipeline friendly
design choices.</p>
<section id="nvidia-profiler">
<h2><span class="section-number">6.1. </span>NVIDIA Profiler<a class="headerlink" href="#nvidia-profiler" title="Permalink to this headline">¶</a></h2>
<p>The NVIDIA Profiler and Visual Profiler tools (part of the CUDA Toolkit)
can be used to profile and visualize Bifrost pipelines. Applications can
be launched directly from the Visual Profiler (nvvp), or a profile can
first be generated using the nvprof command line tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nvprof -o my_pipeline.nvprof python my_pipeline.py
</pre></div>
</div>
<p>The generated .nvprof file can then be imported into the Visual Profiler
for visualisation and analysis.</p>
<p>To obtain a more detailed profile of pipeline execution, reconfigure and rebuild
the bifrost library with “trace” enabled using <cite>./configure –enable-trace</cite>.</p>
</section>
<section id="pipeline-in-dev-shm">
<h2><span class="section-number">6.2. </span>Pipeline in /dev/shm<a class="headerlink" href="#pipeline-in-dev-shm" title="Permalink to this headline">¶</a></h2>
<p>Details about the currently running bifrost pipeline are available in the <code class="docutils literal notranslate"><span class="pre">/dev/shm</span></code>
directory on Linux.  They are mapped into a directory structure (use the linux <code class="docutils literal notranslate"><span class="pre">tree</span></code>
utility to view it):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dancpr@bldcpr:/bldata/bifrost/tools$ tree /dev/shm/bifrost
/dev/shm/bifrost
└── 17263
    └── Pipeline_0
        ├── AccumulateBlock_0
        │   ├── bind
        │   ├── in
        │   ├── out
        │   ├── perf
        │   └── sequence0
        ├── BlockScope_1
        │   ├── PrintHeaderBlock_0
        │   │   ├── bind
        │   │   ├── in
        │   │   ├── out
        │   │   ├── perf
        │   │   └── sequence0
        │   └── TransposeBlock_0
        │       ├── bind
        │       ├── in
        │       ├── out
        │       ├── perf
        │       └── sequence0
        ├── BlockScope_13
        ├...
</pre></div>
</div>
</section>
<section id="like-top-py">
<h2><span class="section-number">6.3. </span>like_top.py<a class="headerlink" href="#like-top-py" title="Permalink to this headline">¶</a></h2>
<p>The main performance monitoring tools is <code class="docutils literal notranslate"><span class="pre">like_top.py</span></code>. This is, as the name suggests, like the linux utility <code class="docutils literal notranslate"><span class="pre">top</span></code>.</p>
<p>..code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">like_top</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span> <span class="n">bldcpr</span> <span class="o">-</span> <span class="n">load</span> <span class="n">average</span><span class="p">:</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.05</span>
<span class="n">Processes</span><span class="p">:</span> <span class="mi">516</span> <span class="n">total</span><span class="p">,</span> <span class="mi">1</span> <span class="n">running</span>
<span class="n">CPU</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>  <span class="mf">1.9</span><span class="o">%</span><span class="n">us</span><span class="p">,</span>  <span class="mf">1.4</span><span class="o">%</span><span class="n">sy</span><span class="p">,</span>  <span class="mf">0.0</span><span class="o">%</span><span class="n">ni</span><span class="p">,</span> <span class="mf">84.5</span><span class="o">%</span><span class="nb">id</span><span class="p">,</span> <span class="mf">12.1</span><span class="o">%</span><span class="n">wa</span><span class="p">,</span>  <span class="mf">0.0</span><span class="o">%</span><span class="n">hi</span><span class="p">,</span>  <span class="mf">0.0</span><span class="o">%</span><span class="n">si</span><span class="p">,</span>  <span class="mf">0.0</span><span class="o">%</span><span class="n">st</span>
<span class="n">Mem</span><span class="p">:</span>   <span class="mi">32341840</span><span class="n">k</span> <span class="n">total</span><span class="p">,</span>  <span class="mi">19834116</span><span class="n">k</span> <span class="n">used</span><span class="p">,</span>  <span class="mi">12507724</span><span class="n">k</span> <span class="n">free</span><span class="p">,</span>    <span class="mi">515556</span><span class="n">k</span> <span class="n">buffers</span>
<span class="n">Swap</span><span class="p">:</span>  <span class="mi">32938492</span><span class="n">k</span> <span class="n">total</span><span class="p">,</span>    <span class="mi">767408</span><span class="n">k</span> <span class="n">used</span><span class="p">,</span>  <span class="mi">32171084</span><span class="n">k</span> <span class="n">free</span><span class="p">,</span>  <span class="mi">17982316</span><span class="n">k</span> <span class="n">cached</span>

   <span class="n">PID</span>            <span class="n">Block</span>  <span class="n">Core</span>   <span class="o">%</span><span class="n">CPU</span>    <span class="n">Total</span>  <span class="n">Acquire</span>  <span class="n">Process</span>  <span class="n">Reserve</span>  <span class="n">Cmd</span>
 <span class="mi">19154</span>  <span class="n">GuppiRawSourceB</span>     <span class="mi">0</span>    <span class="mf">9.4</span>    <span class="mf">0.714</span>    <span class="mf">0.000</span>    <span class="mf">0.714</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>       <span class="n">FftBlock_0</span>     <span class="mi">3</span>    <span class="mf">4.4</span>    <span class="mf">0.733</span>    <span class="mf">0.699</span>    <span class="mf">0.034</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>      <span class="n">CopyBlock_0</span>     <span class="mi">2</span>    <span class="mf">4.4</span>    <span class="mf">0.722</span>    <span class="mf">0.700</span>    <span class="mf">0.021</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>  <span class="n">TransposeBlock_</span>     <span class="mi">1</span>    <span class="mf">3.5</span>    <span class="mf">0.710</span>    <span class="mf">0.695</span>    <span class="mf">0.015</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>  <span class="n">HdfWriteBlock_0</span>     <span class="mi">6</span>    <span class="mf">0.4</span>    <span class="mf">3.220</span>    <span class="mf">3.213</span>    <span class="mf">0.007</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>    <span class="n">DetectBlock_0</span>     <span class="mi">4</span>    <span class="mf">1.0</span>    <span class="mf">0.738</span>    <span class="mf">0.733</span>    <span class="mf">0.005</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>  <span class="n">FftShiftBlock_0</span>     <span class="mi">3</span>    <span class="mf">4.4</span>    <span class="mf">0.738</span>    <span class="mf">0.734</span>    <span class="mf">0.005</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>      <span class="n">CopyBlock_1</span>     <span class="mi">6</span>    <span class="mf">0.4</span>    <span class="mf">2.816</span>    <span class="mf">2.813</span>    <span class="mf">0.003</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>  <span class="n">AccumulateBlock</span>     <span class="mi">5</span>    <span class="mf">4.0</span>    <span class="mf">0.005</span>    <span class="mf">0.005</span>    <span class="mf">0.001</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
 <span class="mi">19154</span>  <span class="n">PrintHeaderBloc</span>    <span class="o">-</span><span class="mi">1</span>           <span class="mf">3.220</span>    <span class="mf">3.220</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>  <span class="n">python</span> <span class="o">./</span><span class="n">bf_gpuspec_midres</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">pulsa</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Acquire is the time spent waiting for input (i.e., waiting on upstream blocks),</p></li>
<li><p>Process is the time spent processing data, and</p></li>
<li><p>Reserve is the time spent waiting for output space to become available in the ring (i.e., waiting for downstream blocks).</p></li>
</ul>
<p>Note: The CPU fraction will probably be 100% on any GPU block because it’s currently set to spin (busy loop) while waiting for the GPU.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">bifrost</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction to Bifrost</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting-started-guide.html">2. Getting started guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create-a-pipeline.html">3. Create a Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="your-first-blocks.html">4. Your first blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">5. Views</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Monitoring Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nvidia-profiler">6.1. NVIDIA Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipeline-in-dev-shm">6.2. Pipeline in /dev/shm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#like-top-py">6.3. like_top.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bfmap.html">7. Fast GPU math using bfMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-Python-and-C---fits-together.html">8. How bifrost fits together</a></li>
<li class="toctree-l1"><a class="reference internal" href="Common-installation-and-execution-problems.html">9. Common Installation and Execution Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="bifrost.blocks.html">10. Block Library Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="bifrost.html">11. Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cpp-Development.html">12. C++ Developement</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp_reference.html">13. C++ Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="views.html" title="previous chapter"><span class="section-number">5. </span>Views</a></li>
      <li>Next: <a href="bfmap.html" title="next chapter"><span class="section-number">7. </span>Fast GPU math using bfMap</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;1980, ledatelescope.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="sources/tools-intro.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>